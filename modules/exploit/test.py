# This file is part of the OpenWire Framework.
#
#    OpenWire is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    OpenWire is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with OpenWIre.  If not, see <http://www.gnu.org/licenses/>.

import socket

class test:

	def __init__(self, framework):
		
		self.name = "Test"
		self.description = "A test module for the python framework"
		self.fw = framework
		self.variables = {}
		self.variables['message'] = {'required' : False, 'description' : 'String to modify', 'default' : 'This is a test string'}

	def loadModule(self):

		return True

	def installModule(self):

		return True

	def check(self):

		print self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("*","red")+self.fw.libs.colours.cstring("] ", "green")+"This module does not support check"

		return True

	def exploit(self):

		self.test()

		return True

	def post(self):

		print "This module does not support Post Exploit"

		return True

	def test(self):
		string = "This is a test string"
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+self.fw.libs.text.warpText(string)

		test = "Checking " + self.target

		hexstr = self.fw.libs.text.strHex(test)
		print "\t"+self.fw.printBox("blue", "+", "green")+hexstr
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+"And back again: " + self.fw.libs.text.hexStr(hexstr)

		base64 = self.fw.libs.text.strBase64(test)
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+base64
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+"And back again: " + self.fw.libs.text.base64Str(base64)

		rot13 = self.fw.libs.text.strRot13(test)
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+rot13
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+"And back again: " + self.fw.libs.text.rot13Str(rot13)	

		spaces = "This is a test+string+with+several different types+of+spaces"	
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+spaces
		print "\t"+self.fw.libs.colours.cstring("[", "green")+self.fw.libs.colours.cstring("+","blue")+self.fw.libs.colours.cstring("] ", "green")+self.fw.libs.text.sqlSpace(spaces)


		

		return True
